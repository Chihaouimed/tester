<!-- File: views/dashboard_views.xml -->
<odoo>
    <!-- Dashboard Form View -->
    <record id="view_pv_dashboard_form" model="ir.ui.view">
        <field name="name">pv.dashboard.form</field>
        <field name="model">pv.dashboard</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" invisible="1"/>
                            <span>Tableau de Bord PV</span>
                        </h1>
                    </div>

                    <!-- Summary KPIs -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="o_dashboard_graph o_graph_linechart">
                                <div class="o_dashboard_graph_title text-center">
                                    Vue d'ensemble
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt16">
                        <!-- KPI Cards for Installations -->
                        <div class="col-md-4">
                            <div class="o_statusbar_status mb16" style="background-color:#17a2b8; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="total_installations"/></div>
                                <div style="font-size:14px;">Installations Totales</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="o_statusbar_status mb16" style="background-color:#28a745; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="active_installations"/></div>
                                <div style="font-size:14px;">Installations Actives</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="o_statusbar_status mb16" style="background-color:#6c757d; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><span t-esc="record.total_installations.raw_value - record.active_installations.raw_value"/></div>
                                <div style="font-size:14px;">Installations Inactives</div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt16">
                        <!-- KPI Cards for Reclamations and Interventions -->
                        <div class="col-md-3">
                            <div class="o_statusbar_status mb16" style="background-color:#007bff; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="total_reclamations"/></div>
                                <div style="font-size:14px;">Réclamations Totales</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="o_statusbar_status mb16" style="background-color:#dc3545; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="open_reclamations"/></div>
                                <div style="font-size:14px;">Réclamations Ouvertes</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="o_statusbar_status mb16" style="background-color:#ffc107; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="total_interventions"/></div>
                                <div style="font-size:14px;">Interventions Totales</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="o_statusbar_status mb16" style="background-color:#fd7e14; color:white; border-radius:5px; padding:15px; text-align:center;">
                                <div style="font-size:36px;"><field name="pending_interventions"/></div>
                                <div style="font-size:14px;">Interventions En Cours</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="row mt32">
                        <div class="col-md-6">
                            <div class="o_dashboard_graph">
                                <div class="o_dashboard_graph_title text-center">
                                    États des Installations
                                </div>
                                <field name="installation_states_chart" widget="dashboard_graph" graph_type="pie"/>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="o_dashboard_graph">
                                <div class="o_dashboard_graph_title text-center">
                                    États des Interventions
                                </div>
                                <field name="intervention_states_chart" widget="dashboard_graph" graph_type="pie"/>
                            </div>
                        </div>
                    </div>

                    <div class="row mt32">
                        <div class="col-md-6">
                            <div class="o_dashboard_graph">
                                <div class="o_dashboard_graph_title text-center">
                                    Réclamations Mensuelles
                                </div>
                                <field name="reclamation_monthly_chart" widget="dashboard_graph" graph_type="bar"/>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="o_dashboard_graph">
                                <div class="o_dashboard_graph_title text-center">
                                    Alarmes par Type
                                </div>
                                <field name="alarms_by_type_chart" widget="dashboard_graph" graph_type="pie"/>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Action Buttons -->
                    <div class="row mt32">
                        <div class="col-md-12">
                            <div class="o_dashboard_graph o_graph_linechart">
                                <div class="o_dashboard_graph_title text-center">
                                    Actions Rapides
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt16 mb32">
                        <div class="col-md-3">
                            <button name="action_view_installations" type="object" class="btn btn-primary btn-block">
                                Voir les Installations
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button name="action_view_reclamations" type="object" class="btn btn-warning btn-block">
                                Voir les Réclamations
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button name="action_view_interventions" type="object" class="btn btn-info btn-block">
                                Voir les Interventions
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button name="action_view_alarms" type="object" class="btn btn-danger btn-block">
                                Voir les Alarmes
                            </button>
                        </div>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action -->
    <record id="action_pv_dashboard" model="ir.actions.act_window">
        <field name="name">Tableau de Bord PV</field>
        <field name="res_model">pv.dashboard</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="context">{}</field>
    </record>

    <!-- Menu Item - Top Level -->
    <menuitem id="menu_pv_dashboard"
              name="Tableau de Bord"
              parent="menu_pv_root"
              action="action_pv_dashboard"
              sequence="1"/>
</odoo>